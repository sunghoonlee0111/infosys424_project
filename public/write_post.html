<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css"
    />
    <link rel="stylesheet" href="style.css" />
    <title>Habitat for Humanity</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Covered+By+Your+Grace&family=Manrope:wght@200..800&display=swap"
      rel="stylesheet"
    />

    <!-- Include stylesheet -->
    <link
      href="https://cdn.jsdelivr.net/npm/quill@2.0.0-rc.4/dist/quill.snow.css"
      rel="stylesheet"
    />
  </head>

  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDiIV3d6YfEggsk3KKLgdWkDI8F4rV8nMk",
      authDomain: "habitat-uw-madison-c.firebaseapp.com",
      projectId: "habitat-uw-madison-c",
      storageBucket: "habitat-uw-madison-c.appspot.com",
      messagingSenderId: "99694309511",
      appId: "1:99694309511:web:44ea8bf5c7db69f4254822",
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);

    // Previous Firebase initialization code...

    import { getFirestore } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";
    import {
      getStorage,
      ref as storageRef,
      uploadBytes,
      getDownloadURL,
    } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-storage.js";

    // Initialize Firestore and Storage
    const db = getFirestore(app);
    const storage = getStorage(app);

    // Continue with your application logic..
  </script>

  <body>
    <!-- header -->
    <header>
      <div class="header max_width_1920">
        <!-- navbar -->
        <nav class="navbar" role="navigation" aria-label="main navigation">
          <div class="navbar-brand">
            <a href="index.html" class="nav_logo"></a>
            <a
              role="button"
              class="navbar-burger"
              id="burger_nav"
              aria-label="menu"
              aria-expanded="false"
              data-target="navbarBasicExample"
            >
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </a>
          </div>
          <div class="navbar-menu" id="menu_nav">
            <div class="navbar-start">
              <a href="index.html" class="navbar-item">HOME</a>
              <a href="about.html" class="navbar-item">ABOUT</a>
              <a href="gallery.html" class="navbar-item">GALLERY</a>
              <a href="post.html" class="navbar-item">POST</a>
              <a href="event.html" class="navbar-item">EVENT</a>
            </div>
            <div class="navbar-end">
              <div class="nav_signin navbar-item">
                <button
                  class="button has-text-black is-rounded"
                  id="user_signin"
                >
                  Sign In
                </button>
              </div>
              <div class="navbar-item">
                <button
                  class="nav_signup button has-text-black is-rounded main-color"
                  id="user_signup"
                >
                  Sign Up
                </button>
              </div>
            </div>
          </div>
        </nav>

        <!-- banner -->
        <img class="index_banner" src="image/Banner.png" alt="Banner Image" />
      </div>
    </header>

    <!-- main -->
    <main class="max_width_1200">
      <!-- write post -->
      <div class="write_post_main">
        <div class="write_post_title">
          <p>WRITE POST</p>
        </div>

        <!-- Write post title -->
        <div class="write_post_title_box">
          <input
            class="write_post_title_input"
            type="text"
            placeholder="Title"
          />
        </div>

        <!-- toolbar -->

        <!-- Create toolbar container -->
        <div id="toolbar">
          <!-- Add font size dropdown -->
          <select class="ql-size">
            <option value="small"></option>
            <option selected></option>
            <option value="large"></option>
            <option value="huge"></option>
          </select>

          <!-- color related buttons -->
          <span class="ql-formats">
            <select class="ql-color"></select>
            <select class="ql-background"></select>
          </span>

          <!-- Add a format button -->
          <span class="ql-formats">
            <button class="ql-bold"></button>
            <button class="ql-italic"></button>
            <button class="ql-underline"></button>
          </span>

          <span class="ql-formats">
            <button class="ql-list" value="ordered"></button>
            <button class="ql-list" value="bullet"></button>
            <button class="ql-indent" value="-1"></button>
            <button class="ql-indent" value="+1"></button>
            <select class="ql-align"></select>
          </span>

          <span class="ql-formats">
            <button class="ql-image"></button>
            <button class="ql-video"></button>
          </span>

          <!-- hidden file input for image upload -->
          <input
            type="file"
            id="fileInput"
            style="display: none"
            accept="image/*"
          />
        </div>

        <!-- toolbar editor -->
        <div id="editor"></div>
        <!-- post button -->
        <div class="write_post_button_box">
          <button class="write_post_button">POST</button>
        </div>
      </div>
    </main>

    <!-- footer -->
    <footer class="max_width_1920">
      <div class="footer_content max_width_1200">
        <!-- footer logo -->
        <div class="footer_logo_and_icons">
          <img
            class="footer_logo_photo"
            src="image/logos/Footer_logo.png"
            alt="footer logo"
          />
          <p class="footer_icons">
            <a href="https://www.facebook.com/HabitatUW">FB</a>
            <a href="https://www.instagram.com/h4huw/">IG</a>
            <a href="">TW</a>
            <a href="https://linktr.ee/h4huw">LT</a>
          </p>
        </div>
        <!-- footer contents -->
        <div class="footer_contents">
          <p>
            Humanity Campus Chapter at the University of Wisconsin â€“ Madison
          </p>
          <p>666 Langdon St, Madison WI 53703</p>

          <p>
            <a href="mailto:absed@gmail.com">absed@gmail.com</a>
            <span class="footer_policy">000-000-0000</span>
          </p>

          <p>
            <span><a href="#" class="footer_a_tag">Term of Use</a></span>
            <span class="footer_policy"
              ><a href="#" class="footer_a_tag">Privacy Policy</a></span
            >
          </p>
        </div>
      </div>
    </footer>

    <!-- Include the Quill library -->
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.0-rc.4/dist/quill.js"></script>

    <!-- Initialize Quill editor -->
    <script>
      // const quill = new Quill("#editor", {
      //   modules: {
      //     toolbar: "#toolbar",
      //   },
      //   theme: "snow",
      //   placeholder: "Write something awesome...",
      // });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const quill = new Quill("#editor", {
          modules: {
            toolbar: "#toolbar",
          },
          theme: "snow",
          placeholder: "Compose an epic...",
        });

        // Add custom handler for image uploads
        function selectLocalImage() {
          const input = document.createElement("input");
          input.setAttribute("type", "file");
          input.setAttribute("accept", "image/*");
          input.click();

          // Listen for file input change
          input.onchange = () => {
            const file = input.files[0];
            if (file) {
              // Convert image file to Base64 string and insert into editor
              const reader = new FileReader();
              reader.onload = function (e) {
                const range = quill.getSelection();
                quill.insertEmbed(range.index, "image", e.target.result);
              };
              reader.readAsDataURL(file);
            }
          };
        }

        quill.getModule("toolbar").addHandler("image", selectLocalImage);

        // Event listener for the POST button
        document
          .querySelector(".write_post_button")
          .addEventListener("click", function () {
            // Retrieve the content from the editor
            const content = quill.root.innerHTML;

            // TODO: Extract Base64 images from content, upload to server, and replace with server URLs
            // For now, just log the content
            console.log(content);

            // After handling image uploads and content, you can POST to the server here
          });
      });
    </script>

    <!-- <script>
      document.addEventListener("DOMContentLoaded", function () {
        const quill = new Quill("#editor", {
          modules: {
            toolbar: "#toolbar",
          },
          theme: "snow",
          placeholder: "Write something awesome...",
        });

        // Function to handle image uploads
        function imageHandler() {
          const input = document.createElement("input");
          input.setAttribute("type", "file");
          input.setAttribute("accept", "image/*");
          input.click();

          // Listen for file input change and handle the image
          input.onchange = () => {
            const file = input.files[0];
            if (file) {
              // Create a temporary URL to display the image
              const reader = new FileReader();
              reader.onload = (e) => {
                const range = quill.getSelection(true);
                quill.insertEmbed(range.index, "image", e.target.result);
                // You may want to save the file object here to upload it later
              };
              reader.readAsDataURL(file);
            }
          };
        }

        // Add custom handler for image uploads
        quill.getModule("toolbar").addHandler("image", imageHandler);

        // Post button event listener
        document
          .querySelector(".write_post_button")
          .addEventListener("click", function () {
            // Here you would gather the content of the editor
            const content = quill.root.innerHTML;

            // And here you would handle the image upload
            // For each image in the content, upload it to your server
            // and replace the src attribute with the URL returned from the server

            // After images are uploaded and URLs updated, post the content to the server
            console.log(content);
            // Example POST request to your server with the content
          });
      });
    </script> -->
  </body>
  <script src="app.js"></script>
</html>
